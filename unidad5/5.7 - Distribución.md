# üì¶ Distribuci√≥n de aplicaciones Windows Forms

Cuando terminas de programar una aplicaci√≥n de escritorio, necesitas **empaquetarla y distribuirla** a los usuarios. En C# hay varias formas de hacerlo, dependiendo de las necesidades (simplicidad, control, actualizaciones, portabilidad).

---

## 1. Distribuci√≥n b√°sica: copiar el ejecutable
- Al compilar en **modo Release**, Visual Studio genera el `.exe` en:
  ```
  \bin\Release\netX.X\
  ```
  Para realizar la compilaci√≥n, nos posicionamos en el explorador de soluciones y pulsamos el bot√≥n derecho sobre el nombre del proyecto. A continuaci√≥n escogemos la opci√≥n Compilar.
- Para apps peque√±as, basta con copiar ese `.exe` junto con las **librer√≠as necesarias** (`.dll`) y el archivo `.runtimeconfig.json` al equipo destino.
- Problema: requiere que el usuario tenga la **versi√≥n correcta de .NET Runtime** instalada. <br><br>
Para instalarla (en caso necesario):
https://www.oracle.com/database/technologies/appdev/dotnet/install-dotnetcore-windows.html



## 2. Publicar en Carpeta

### üì¶ Paso a paso

### 1. Preparar el proyecto

-   Abre tu soluci√≥n **Windows Forms** en **Visual Studio**.\
-   Compila en modo **Release** (men√∫ desplegable arriba: Debug ‚Üí
    Release) (bot√≥n derecho en el proyecto: Compilar).

### 2. Publicar en carpeta

1.  En el **Explorador de soluciones**, haz clic derecho sobre tu
    proyecto principal ‚Üí **Publicar**.\
2.  Se abre el asistente de publicaci√≥n:
    -   Elige **Carpeta** como destino.\
    -   Selecciona la ruta donde quieres que Visual Studio genere los
        archivos publicados (ejemplo: `C:\Publicaciones\MiApp`).\
    -   Haz clic en **Finalizar**.
3.  Ahora, cada vez que presiones **Publicar**, Visual Studio generar√°
    los binarios en esa carpeta.

------------------------------------------------------------------------

### 3. Contenido generado

Dependiendo de c√≥mo configures la publicaci√≥n tendr√°s 2 casos:

#### üîπ Opci√≥n A: Framework dependiente

-   Solo genera tu `.exe` y los dll de tu proyecto.\
-   **Requiere que en la m√°quina cliente ya est√© instalado el .NET
    Runtime** correspondiente (ejemplo: .NET 6 Runtime Desktop).

#### üîπ Opci√≥n B: Publicaci√≥n independiente (*self-contained*)

-   Genera un paquete m√°s grande (incluye `.exe`, `.dll`, y librer√≠as
    del runtime de .NET).\
-   **No necesitas instalar nada en la m√°quina cliente**.\
-   Para esto, en la ventana de publicaci√≥n:
    -   Edita la configuraci√≥n ‚Üí **Configuraci√≥n del perfil de
        publicaci√≥n** ‚Üí selecciona **Publicar independiente**.\
    -   Escoge la plataforma (`win-x86` o `win-x64`).

------------------------------------------------------------------------

### 4. Distribuir a los usuarios

-   Una vez publicada la carpeta, puedes:
    -   **Copiarla en un USB** y entregarla.\
    -   **Compartirla en red** (ej: carpeta compartida en LAN).\
    -   **Comprimirla en .zip** y subirla a un servidor, correo, etc.\
-   El usuario solo necesita abrir el archivo **`MiApp.exe`**.

## 3. Instalador MSI (Windows Installer)
### üì¶ Paso a paso
### 1. Preparaci√≥n
1. Compilar en **Release**.
2. Instalar la extensi√≥n **Visual Studio Installer Projects**.<br>
Para ello, vamos al men√∫ principal -> Extensiones -> Administrar extensiones. <br>
Si en la pesta√±a *Instalado* no la encuentras, vamos a la pesta√±a *Examinaci√≥n*, buscamos la extensi√≥n **Microsoft Visual Studio Installer Projects 2002**, la descargamos e instalamos. <br>IMPORTANTE: Fijarse bien porque indica *Los cambios se programar√°n. Las modificaciones comenzar√°n cuando cierre el Visual Studio*. As√≠ que debemos cerrar Visual Studio para que la instalaci√≥n de la extensi√≥n se complete.


### 2. Crear el proyecto de instalaci√≥n
1. Nuevo proyecto ‚Üí **Setup Project**. <br>
En el explorador de soluciones, pulsamos bot√≥n derecho sobre la soluci√≥n y agregamos un nuevo proyecto del tipo indicado (escogemos nombre y ubicaci√≥n).  
2. Agregar **Resultado del proyecto**.<br>Pulsamos bot√≥n derecho en **Aplication Folder** y seleccionamos Add -> Resultados del proyecto -> Publicar elementos.  
3. A√±adir archivos extra si son necesarios.



### 3. Accesos directos
1. En **Application Folder**, localiza en el panel derecho el **Publicar elemento...**.  
2. Clic derecho ‚Üí **Create Shortcut to ...**.  
3. En la ventana de propiedades, cambiamos su nombre (ej: `MiApp`).  
4. Arr√°stralo al componente del panel izquierdo:  
   - **User‚Äôs Desktop** (para crear acceso en el escritorio).
   <br>o  
   - **User‚Äôs Programs Menu ‚Üí MiApp** (para men√∫ inicio).  


### 4. Configurar propiedades del instalador
En el explorador de soluciones, selecciona el proyecto Setup ‚Üí Ventana de propiedades:

- **ProductName** ‚Üí Nombre de la app (ej: `MiApp`).  
- **Manufacturer** ‚Üí Tu nombre/empresa.  
- **Version** ‚Üí Ej: `1.0.0`.  
- **RemovePreviousVersions** ‚Üí `True` (para que al instalar una nueva versi√≥n se desinstale la anterior).  
- **InstallAllUsers** ‚Üí `True` (se instala en *Program Files* y requiere permisos de administrador).  



### 5. Agregar otros archivos (opcional)
- Clic derecho en **Application Folder ‚Üí Add ‚Üí File‚Ä¶** para incluir recursos externos (`.json`, im√°genes, dlls adicionales).  
- Tambi√©n puedes a√±adir carpetas completas.


### 6. Compilar el instalador
1. Clic derecho en el proyecto Setup ‚Üí **Build**.  
2. Revisa la carpeta de salida (ejemplo):  
   ```
   \MiApp.Setup\bin\Release\
   ```
3. All√≠ encontrar√°s el archivo `.msi` y, si lo configuraste, tambi√©n un `.exe` bootstrapper.

### 7. Probar el instalador
- Ejecuta el `.msi` en una m√°quina de prueba (idealmente una **VM limpia**).  
- Verifica que:  
  - Se copian todos los archivos.  
  - Se crean los accesos directos.  
  - Aparece en **Panel de control ‚Üí Programas y caracter√≠sticas**.  
  - Puede desinstalarse correctamente.  



## üöÄ Resultado final
Tendr√°s un archivo **MSI** que:
- Instala tu aplicaci√≥n en *Program Files*.  
- Crea accesos directos en escritorio y men√∫ inicio.  
- Aparece en el **Panel de control** con opci√≥n de desinstalaci√≥n.  

