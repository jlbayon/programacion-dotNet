# üß© C√≥digo C# (Visual Studio - ADO.NET con Access)

Este c√≥digo se utiliza para **conectarse a una base de datos Access (.accdb)**, ejecutar una consulta SQL y mostrar los resultados en un control de texto (`TextBox`). Se usa normalmente en aplicaciones **Windows Forms** o **WPF** dentro de **Visual Studio**.

---

## üîπ 1. Crear la cadena de conexi√≥n
```csharp
string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"C:\\Users\\Curso .NET\\Desktop\\ADO.NET\\BD Academia\\Academia.accdb\"";
```

- **Qu√© hace:** define c√≥mo conectarse a la base de datos.  
- `Provider=Microsoft.ACE.OLEDB.12.0`: especifica el controlador OLE DB para bases de datos Access (.accdb).  
- `Data Source=...`: ruta completa al archivo de base de datos Access.  
- Las comillas escapadas (`\"`) se usan porque la ruta contiene espacios.

---

## üîπ 2. Crear la conexi√≥n
```csharp
OleDbConnection conn = new OleDbConnection(connectionString);
```

- Crea un objeto `OleDbConnection` usando la cadena de conexi√≥n.  
- **No abre** la conexi√≥n todav√≠a, solo la prepara.

---

## üîπ 3. Abrir la conexi√≥n
```csharp
conn.Open();
```

- Abre la conexi√≥n con la base de datos.  
- Si la ruta es incorrecta o el archivo est√° bloqueado, lanzar√° una excepci√≥n.

---

## üîπ 4. Crear la consulta SQL
```csharp
string sql = "SELECT AlumnoId, Nombre, Apellidos, Ciudad FROM Alumnos";
```

- Define la instrucci√≥n SQL que selecciona columnas de la tabla `Alumnos`.  
- Los campos obtenidos son: `AlumnoId`, `Nombre`, `Apellidos`, `Ciudad`.

---

## üîπ 5. Crear el comando
```csharp
OleDbCommand cmd = new OleDbCommand(sql, conn);
```

- Crea un comando SQL (`OleDbCommand`) asociado a la conexi√≥n abierta.  
- Permite ejecutar la consulta sobre la base de datos.

---

## üîπ 6. Ejecutar la consulta
```csharp
OleDbDataReader reader = cmd.ExecuteReader();
```

- Ejecuta la instrucci√≥n `SELECT`.  
- Devuelve un objeto `OleDbDataReader`, que permite **leer los resultados fila por fila** (solo hacia adelante).

---

## üîπ 7. Mostrar cabeceras en el TextBox
```csharp
txtInfo.AppendText("\n\nID\tNombre\t\tApellidos\t\tCiudad" + Environment.NewLine);
txtInfo.AppendText("--\t------\t\t----------\t\t-------" + Environment.NewLine);
```

- Agrega texto al control `txtInfo` (un `TextBox` multilinea).  
- Usa `\t` para tabulaciones y `Environment.NewLine` para saltos de l√≠nea.  
- Muestra las cabeceras de las columnas en formato tabular.

---

## üîπ 8. Leer los datos fila a fila
```csharp
while (reader.Read())
{
    int id = reader.GetInt32(0);
    string nombre = reader.GetString(1);
    string apellidos = reader.GetString(2);
    string ciudad = reader.IsDBNull(3) ? "(sin ciudad)" : reader.GetString(3);

    txtInfo.AppendText($"{id}\t{nombre}\t\t{apellidos}\t\t{ciudad}" + Environment.NewLine);
}
```

- `reader.Read()` avanza a la siguiente fila.  
- Se obtienen los valores por √≠ndice de columna:
  - `GetInt32(0)` ‚Üí `AlumnoId`
  - `GetString(1)` ‚Üí `Nombre`
  - `GetString(2)` ‚Üí `Apellidos`
  - `IsDBNull(3)` ‚Üí comprueba si `Ciudad` es nulo. Si lo es, muestra ‚Äú(sin ciudad)‚Äù.  
- Muestra cada fila en el `TextBox` con formato tabular.

---

## üîπ 9. Cerrar el lector y la conexi√≥n
```csharp
reader.Close();
conn.Close();
```

- Cierra el lector de datos (`DataReader`) y la conexi√≥n.  
- Es importante para **liberar los recursos** del sistema.

---

## üß† En resumen

Este c√≥digo:

1. Se conecta a una base de datos **Access (.accdb)**.  
2. Ejecuta una consulta `SELECT` sobre la tabla `Alumnos`.  
3. Muestra los resultados (ID, nombre, apellidos y ciudad) en un `TextBox`.

---

## üí° Mejora recomendada

Se puede usar la estructura `using` para que las conexiones y lectores se cierren autom√°ticamente, incluso si ocurre un error:

```csharp
using (OleDbConnection conn = new OleDbConnection(connectionString))
{
    conn.Open();
    using (OleDbCommand cmd = new OleDbCommand(sql, conn))
    using (OleDbDataReader reader = cmd.ExecuteReader())
    {
        while (reader.Read())
        {
            // leer datos aqu√≠
        }
    }
}
```

‚úÖ As√≠ no es necesario llamar manualmente a `Close()`, y el sistema libera los recursos de forma autom√°tica.
