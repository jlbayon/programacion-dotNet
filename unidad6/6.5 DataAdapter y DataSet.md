
# 🧩 DataAdapter y DataSet en ADO.NET

## 💡 ¿Qué es un DataAdapter?
El **`DataAdapter`** actúa como un **puente** entre la base de datos y los objetos en memoria como el **`DataSet`** o **`DataTable`**.  
Permite **llenar datos** desde la base de datos hacia la aplicación y **actualizar** los cambios hechos en memoria de nuevo hacia la base de datos.

👉 Se utiliza en **modo desconectado**, lo que significa que la conexión a la base de datos se **abre solo cuando es necesario** (por ejemplo, al llenar o actualizar datos) y luego se **cierra automáticamente**.

---

## 🔹 Clases relacionadas

| Clase | Descripción |
|--------|--------------|
| **`SqlDataAdapter`** | Se utiliza para SQL Server. |
| **`OleDbDataAdapter`** | Se utiliza para Access y otras fuentes OLE DB. |
|**`MySqlDataAdapter`** | Se utiliza para MySql. |
| **`OdbcDataAdapter`** | Se utiliza para conexiones ODBC genéricas. |

---

## ⚙️ Métodos principales del DataAdapter

| Método | Descripción |
|---------|--------------|
| **`Fill()`** | Llena un `DataSet` o `DataTable` con datos de la base de datos. |
| **`Update()`** | Envía los cambios realizados en el `DataSet` o `DataTable` de nuevo a la base de datos. |
| **`SelectCommand`** | Sentencia SQL para recuperar datos. |
| **`InsertCommand`**, **`UpdateCommand`**, **`DeleteCommand`** | Comandos para insertar, modificar o eliminar datos en la base de datos. |

---

## 💾 ¿Qué es un DataSet?
El **`DataSet`** es un **contenedor en memoria** que almacena uno o varios **DataTable** (tablas).  
Se puede pensar en él como una **base de datos virtual desconectada** del servidor.

### Características
- Puede contener múltiples tablas (`DataTable`).  
- Puede definir relaciones (`DataRelation`) entre las tablas.  
- Permite trabajar con datos sin conexión activa.  
- Puede guardar y cargar datos en formato XML (`ReadXml()`, `WriteXml()`).

---

## 🧩 Ejemplo práctico

### 🧮 Llenar un DataTable desde MySQL

Este ejemplo muestra cómo llenar un **DataTable** en memoria desde una base de datos **MySQL** usando el proveedor oficial `MySql.Data.MySqlClient`.

---



```csharp
using System;
using System.Data;
using MySql.Data.MySqlClient; 

class Program
{
    static void Main()
    {
        // 1️⃣ Cadena de conexión a MySQL
        string cadena = "Server=localhost;Database=MiBase;Uid=usuario;Pwd=contraseña;";

        // 2️⃣ Crear el adaptador con la consulta SQL
        MySqlDataAdapter adaptador = new MySqlDataAdapter("SELECT * FROM Clientes", cadena);

        // 3️⃣ Crear un DataTable en memoria
        DataTable tabla = new DataTable();

        // 4️⃣ Llenar el DataTable con los datos de la base de datos
        adaptador.Fill(tabla);

        // 5️⃣ Recorrer las filas y mostrar los datos
        foreach (DataRow fila in tabla.Rows)
        {
            Console.WriteLine($"{fila["Id"]} - {fila["Nombre"]}");
        }

        Console.WriteLine("✅ Datos cargados correctamente desde MySQL.");
    }
}
```

---

## ⚙️ Explicación paso a paso

| Paso | Descripción |
|------|--------------|
| **1️⃣** | Se define la cadena de conexión con los parámetros del servidor MySQL. |
| **2️⃣** | Se crea un `MySqlDataAdapter`, encargado de ejecutar la consulta SQL. |
| **3️⃣** | Se crea un `DataTable` que servirá como contenedor en memoria. |
| **4️⃣** | El método `Fill()` carga los datos de la base de datos dentro del `DataTable`. |
| **5️⃣** | Se recorren las filas (`Rows`) del `DataTable` para mostrar los resultados. |

---

## 🧠 Requisitos

1. Instalar el paquete **NuGet** para MySQL:
   ```bash
   dotnet add package MySql.Data
   ```
   o desde Visual Studio:  
   `Herramientas → Administrar paquetes NuGet → Buscar “MySql.Data” → Instalar`
<br>
2. Asegúrate de tener una tabla llamada **Clientes** en tu base de datos con al menos las columnas:
   ```sql
   Id INT PRIMARY KEY AUTO_INCREMENT,
   Nombre VARCHAR(100)
   ```

---



## ✅ En resumen

- **`MySqlDataAdapter`** ejecuta la consulta SQL y trae los datos.  
- **`DataTable`** almacena los resultados en memoria.  
- **`Fill()`** realiza la carga de datos.  
- Puedes recorrer las filas con un bucle `foreach` para acceder a cada registro.





- La conexión se abre y cierra automáticamente.
- Los datos quedan disponibles incluso sin conexión.

---

### 🧮 Actualizar datos modificados

```csharp
using System;
using System.Data;
using MySql.Data.MySqlClient; // 👈 Necesario para trabajar con MySQL

class Program
{
    static void Main()
    {
        // 1️⃣ Cadena de conexión a MySQL
        // Cambia los valores según tu configuración
        string cadena = "Server=localhost;Database=MiBase;Uid=usuario;Pwd=contraseña;";

        // 2️⃣ Crear adaptador y comando SQL
        MySqlDataAdapter adaptador = new MySqlDataAdapter("SELECT * FROM Clientes", cadena);

        // 3️⃣ Crear el generador automático de comandos (INSERT, UPDATE, DELETE)
        MySqlCommandBuilder constructor = new MySqlCommandBuilder(adaptador);

        // 4️⃣ Crear tabla en memoria y llenarla
        DataTable tabla = new DataTable();
        adaptador.Fill(tabla);

        // 5️⃣ Modificar datos en memoria
        if (tabla.Rows.Count > 0)
        {
            tabla.Rows[0]["Nombre"] = "Juan Actualizado";
        }

        // 6️⃣ Aplicar los cambios a la base de datos
        adaptador.Update(tabla);

        Console.WriteLine("✅ Cambios actualizados correctamente en la base de datos MySQL.");
    }
}
```

---

### ⚙️ Explicación paso a paso

| Paso | Descripción |
|------|--------------|
| 1️⃣ | Se define la **cadena de conexión** con los parámetros de MySQL. |
| 2️⃣ | `MySqlDataAdapter` ejecuta la consulta SQL y trae los datos. |
| 3️⃣ | `MySqlCommandBuilder` genera automáticamente los comandos `INSERT`, `UPDATE`, `DELETE`. |
| 4️⃣ | Los datos se cargan en un `DataTable` en memoria. |
| 5️⃣ | Se modifica el contenido del `DataTable` localmente. |
| 6️⃣ | `Update()` sincroniza los cambios con la base de datos MySQL. |

---

## 🧠 Diagrama conceptual

```plaintext
     ┌───────────────────────┐
     │     DataAdapter       │
     │  (Select / Update)    │
     └──────────┬────────────┘
                │
                ▼
     ┌───────────────────────┐
     │       DataSet         │
     │  ┌───────────────┐    │
     │  │  DataTable(s) │    │
     │  └───────────────┘    │
     └───────────────────────┘
```

---

## ⚖️ Comparación rápida

| Característica | DataAdapter | DataSet |
|----------------|-------------|----------|
| **Función principal** | Conectar la BD con la memoria (transferir datos) | Almacenar los datos en memoria |
| **Modo de trabajo** | Intermediario (abre y cierra conexión) | Totalmente desconectado |
| **Contiene datos** | No directamente | Sí, uno o varios DataTable |
| **Uso común** | Llenar y actualizar | Manipular y consultar datos |

---

## ✅ En resumen
- **`DataAdapter`** → mueve los datos entre la base de datos y el `DataSet` o `DataTable`.  
- **`DataSet`** → almacena los datos localmente y permite trabajar con ellos sin conexión.  
- Ambos permiten trabajar con datos de manera **eficiente, flexible y desconectada** en ADO.NET.
