
# ğŸ§© DataAdapter y DataSet en ADO.NET

## ğŸ’¡ Â¿QuÃ© es un DataAdapter?
El **`DataAdapter`** actÃºa como un **puente** entre la base de datos y los objetos en memoria como el **`DataSet`** o **`DataTable`**.  
Permite **llenar datos** desde la base de datos hacia la aplicaciÃ³n y **actualizar** los cambios hechos en memoria de nuevo hacia la base de datos.

ğŸ‘‰ Se utiliza en **modo desconectado**, lo que significa que la conexiÃ³n a la base de datos se **abre solo cuando es necesario** (por ejemplo, al llenar o actualizar datos) y luego se **cierra automÃ¡ticamente**.

---

## ğŸ”¹ Clases relacionadas

| Clase | DescripciÃ³n |
|--------|--------------|
| **`SqlDataAdapter`** | Se utiliza para SQL Server. |
| **`OleDbDataAdapter`** | Se utiliza para Access y otras fuentes OLE DB. |
|**`MySqlDataAdapter`** | Se utiliza para MySql. |
| **`OdbcDataAdapter`** | Se utiliza para conexiones ODBC genÃ©ricas. |

---

## âš™ï¸ MÃ©todos principales del DataAdapter

| MÃ©todo | DescripciÃ³n |
|---------|--------------|
| **`Fill()`** | Llena un `DataSet` o `DataTable` con datos de la base de datos. |
| **`Update()`** | EnvÃ­a los cambios realizados en el `DataSet` o `DataTable` de nuevo a la base de datos. |
| **`SelectCommand`** | Sentencia SQL para recuperar datos. |
| **`InsertCommand`**, **`UpdateCommand`**, **`DeleteCommand`** | Comandos para insertar, modificar o eliminar datos en la base de datos. |

---

## ğŸ’¾ Â¿QuÃ© es un DataSet?
El **`DataSet`** es un **contenedor en memoria** que almacena uno o varios **DataTable** (tablas).  
Se puede pensar en Ã©l como una **base de datos virtual desconectada** del servidor.

### CaracterÃ­sticas
- Puede contener mÃºltiples tablas (`DataTable`).  
- Puede definir relaciones (`DataRelation`) entre las tablas.  
- Permite trabajar con datos sin conexiÃ³n activa.  
- Puede guardar y cargar datos en formato XML (`ReadXml()`, `WriteXml()`).

---

## ğŸ§© Ejemplo prÃ¡ctico

### ğŸ§® Llenar un DataTable desde MySQL

Este ejemplo muestra cÃ³mo llenar un **DataTable** en memoria desde una base de datos **MySQL** usando el proveedor oficial `MySql.Data.MySqlClient`.

---



```csharp
using System;
using System.Data;
using MySql.Data.MySqlClient; 

class Program
{
    static void Main()
    {
        // 1ï¸âƒ£ Cadena de conexiÃ³n a MySQL
        string cadena = "Server=localhost;Database=MiBase;Uid=usuario;Pwd=contraseÃ±a;";

        // 2ï¸âƒ£ Crear el adaptador con la consulta SQL
        MySqlDataAdapter adaptador = new MySqlDataAdapter("SELECT * FROM Clientes", cadena);

        // 3ï¸âƒ£ Crear un DataTable en memoria
        DataTable tabla = new DataTable();

        // 4ï¸âƒ£ Llenar el DataTable con los datos de la base de datos
        adaptador.Fill(tabla);

        // 5ï¸âƒ£ Recorrer las filas y mostrar los datos
        foreach (DataRow fila in tabla.Rows)
        {
            Console.WriteLine($"{fila["Id"]} - {fila["Nombre"]}");
        }

        Console.WriteLine("âœ… Datos cargados correctamente desde MySQL.");
    }
}
```

---

## âš™ï¸ ExplicaciÃ³n paso a paso

| Paso | DescripciÃ³n |
|------|--------------|
| **1ï¸âƒ£** | Se define la cadena de conexiÃ³n con los parÃ¡metros del servidor MySQL. |
| **2ï¸âƒ£** | Se crea un `MySqlDataAdapter`, encargado de ejecutar la consulta SQL. |
| **3ï¸âƒ£** | Se crea un `DataTable` que servirÃ¡ como contenedor en memoria. |
| **4ï¸âƒ£** | El mÃ©todo `Fill()` carga los datos de la base de datos dentro del `DataTable`. |
| **5ï¸âƒ£** | Se recorren las filas (`Rows`) del `DataTable` para mostrar los resultados. |

---

## ğŸ§  Requisitos

1. Instalar el paquete **NuGet** para MySQL:
   ```bash
   dotnet add package MySql.Data
   ```
   o desde Visual Studio:  
   `Herramientas â†’ Administrar paquetes NuGet â†’ Buscar â€œMySql.Dataâ€ â†’ Instalar`
<br>
2. AsegÃºrate de tener una tabla llamada **Clientes** en tu base de datos con al menos las columnas:
   ```sql
   Id INT PRIMARY KEY AUTO_INCREMENT,
   Nombre VARCHAR(100)
   ```

---



## âœ… En resumen

- **`MySqlDataAdapter`** ejecuta la consulta SQL y trae los datos.  
- **`DataTable`** almacena los resultados en memoria.  
- **`Fill()`** realiza la carga de datos.  
- Puedes recorrer las filas con un bucle `foreach` para acceder a cada registro.





- La conexiÃ³n se abre y cierra automÃ¡ticamente.
- Los datos quedan disponibles incluso sin conexiÃ³n.

---

### ğŸ§® Actualizar datos modificados

```csharp
using System;
using System.Data;
using MySql.Data.MySqlClient; // ğŸ‘ˆ Necesario para trabajar con MySQL

class Program
{
    static void Main()
    {
        // 1ï¸âƒ£ Cadena de conexiÃ³n a MySQL
        // Cambia los valores segÃºn tu configuraciÃ³n
        string cadena = "Server=localhost;Database=MiBase;Uid=usuario;Pwd=contraseÃ±a;";

        // 2ï¸âƒ£ Crear adaptador y comando SQL
        MySqlDataAdapter adaptador = new MySqlDataAdapter("SELECT * FROM Clientes", cadena);

        // 3ï¸âƒ£ Crear el generador automÃ¡tico de comandos (INSERT, UPDATE, DELETE)
        MySqlCommandBuilder constructor = new MySqlCommandBuilder(adaptador);

        // 4ï¸âƒ£ Crear tabla en memoria y llenarla
        DataTable tabla = new DataTable();
        adaptador.Fill(tabla);

        // 5ï¸âƒ£ Modificar datos en memoria
        if (tabla.Rows.Count > 0)
        {
            tabla.Rows[0]["Nombre"] = "Juan Actualizado";
        }

        // 6ï¸âƒ£ Aplicar los cambios a la base de datos
        adaptador.Update(tabla);

        Console.WriteLine("âœ… Cambios actualizados correctamente en la base de datos MySQL.");
    }
}
```

---

### âš™ï¸ ExplicaciÃ³n paso a paso

| Paso | DescripciÃ³n |
|------|--------------|
| 1ï¸âƒ£ | Se define la **cadena de conexiÃ³n** con los parÃ¡metros de MySQL. |
| 2ï¸âƒ£ | `MySqlDataAdapter` ejecuta la consulta SQL y trae los datos. |
| 3ï¸âƒ£ | `MySqlCommandBuilder` genera automÃ¡ticamente los comandos `INSERT`, `UPDATE`, `DELETE`. |
| 4ï¸âƒ£ | Los datos se cargan en un `DataTable` en memoria. |
| 5ï¸âƒ£ | Se modifica el contenido del `DataTable` localmente. |
| 6ï¸âƒ£ | `Update()` sincroniza los cambios con la base de datos MySQL. |

---

## ğŸ§  Diagrama conceptual

```plaintext
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚     DataAdapter       â”‚
     â”‚  (Select / Update)    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       DataSet         â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
     â”‚  â”‚  DataTable(s) â”‚    â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš–ï¸ ComparaciÃ³n rÃ¡pida

| CaracterÃ­stica | DataAdapter | DataSet |
|----------------|-------------|----------|
| **FunciÃ³n principal** | Conectar la BD con la memoria (transferir datos) | Almacenar los datos en memoria |
| **Modo de trabajo** | Intermediario (abre y cierra conexiÃ³n) | Totalmente desconectado |
| **Contiene datos** | No directamente | SÃ­, uno o varios DataTable |
| **Uso comÃºn** | Llenar y actualizar | Manipular y consultar datos |

---

## âœ… En resumen
- **`DataAdapter`** â†’ mueve los datos entre la base de datos y el `DataSet` o `DataTable`.  
- **`DataSet`** â†’ almacena los datos localmente y permite trabajar con ellos sin conexiÃ³n.  
- Ambos permiten trabajar con datos de manera **eficiente, flexible y desconectada** en ADO.NET.
